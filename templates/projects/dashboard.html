{% extends 'base.html' %}

{% block title %}Tablero{% endblock %}

{% block content %}
<style>
    .welcome-banner {
        background-color: #ffffff; /* White background */
        color: #000;
        padding: 20px;
        border-radius: 5px;
        margin-bottom: 20px;
        border: 1px solid #ddd;
    }
    .alert-card {
        background-color: #ffc107; /* Mustard background */
        border: 1px solid #e0a800;
        border-radius: 5px;
        padding: 15px;
        margin-bottom: 15px;
    }
</style>

<div class="welcome-banner">
    <h2>¡Bienvenido, {{ user.username }}!</h2>
    <p>Rol: {{ user_role }}</p>
</div>

<div class="alert-card">
    <h4>Proyectos Activos</h4>
    <p>{{ active_projects|length }} proyecto(s) en progreso o planificación.</p>
    {% for project in active_projects %}
        <div><a href="{% url 'project_detail' project.pk %}">{{ project.name }}</a></div>
    {% endfor %}
</div>

<div class="alert-card">
    <h4>Tareas Pendientes</h4>
    <p>{{ pending_tasks|length }} actividad(es) pendiente(s).</p>
    {% for task in pending_tasks|slice:":5" %}
        <div>{{ task.name }} ({{ task.project.name }})</div>
    {% endfor %}
</div>

<div class="alert-card">
    <h4>Últimos Reportes</h4>
    {% for report in latest_reports %}
        <div>{{ report.fecha }} - {{ report.proyecto.name }} (PV: ${{ report.pv }}, EV: ${{ report.ev }}, CPI: {{ report.cpi }})</div>
    {% empty %}
        <p>No hay reportes recientes.</p>
    {% endfor %}
</div>

<div class="row">
    <div class="col-md-6">
        <h2>Tus Proyectos</h2>
        <ul class="list-group">
            {% for project in projects %}
                <li class="list-group-item">
                    <a href="{% url 'project_detail' project.pk %}">{{ project.name }}</a>
                    <span class="badge bg-secondary">{{ project.get_status_display }}</span>
                </li>
            {% empty %}
                <li class="list-group-item">No hay proyectos aún. <a href="{% url 'project_create' %}">Crear uno</a></li>
            {% endfor %}
        </ul>
    </div>
    <div class="col-md-6">
        <h2>Acciones Rápidas</h2>
        <a href="{% url 'project_create' %}" class="btn btn-primary">Crear Proyecto</a>
        <a href="{% url 'activity_create' %}" class="btn btn-secondary">Agregar Actividad</a>
        <a href="{% url 'milestone_create' %}" class="btn btn-info">Agregar Hito</a>
        <a href="{% url 'seguimiento_create' %}" class="btn btn-warning">Crear Seguimiento</a>
    </div>
</div>
{% endblock %}