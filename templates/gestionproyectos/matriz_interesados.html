{% extends 'gestionproyectos/base.html' %}
{% block gestion_content %}
<div class="container-fluid">
    <h1 class="page-title-gad mb-4">Matriz Poder / Interés - Interesados</h1>
    <p class="text-muted">Clasificación de interesados según nivel de poder e interés en el proyecto (REQ-002).</p>

    <div class="table-responsive">
        <table class="table table-gad table-bordered">
            <thead>
                <tr>
                    <th></th>
                    {% for valor, etiqueta in niveles_interes %}
                    <th class="text-center bg-light">Interés {{ etiqueta }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for poder_etiq, fila in matriz_celdas %}
                <tr>
                    <th class="bg-light">Poder {{ poder_etiq }}</th>
                    {% for celda in fila %}
                    <td class="p-2">
                        {% for i in celda %}
                        <div class="mb-2 p-2 rounded matriz-celda-alta">
                            <strong>{{ i.nombre }} {{ i.apellido }}</strong><br>
                            <small>{{ i.rol }}</small><br>
                            <a href="{% url 'gestionproyecto:interesado_detail' i.slug %}" class="btn btn-sm btn-gad-primary mt-1">Ver</a>
                        </div>
                        {% endfor %}
                    </td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <h3 class="h5 mt-4">Todos los interesados</h3>
    <table class="table table-gad table-striped mt-2">
        <thead>
            <tr>
                <th>Nombre</th>
                <th>Rol</th>
                <th>Poder</th>
                <th>Interés</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for i in interesados %}
            <tr>
                <td>{{ i.nombre }} {{ i.apellido }}</td>
                <td>{{ i.rol }}</td>
                <td>{{ i.get_nivel_poder_display }}</td>
                <td>{{ i.get_nivel_interes_display }}</td>
                <td><a href="{% url 'gestionproyecto:interesado_detail' i.slug %}" class="btn btn-sm btn-gad-primary">Ver</a></td>
            </tr>
            {% empty %}
            <tr><td colspan="5" class="text-center text-muted">No hay interesados registrados.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock gestion_content %}
